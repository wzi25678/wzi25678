CSDN首页
博客
下载
学习
社区
GitCode
云服务
猿如意
opensips教程
 搜索

会员中心 
足迹
动态
消息
创作中心
发布
opensips（1）——安装opensips详细流程

李王家的翠花

已于 2022-02-15 10:45:51 修改

2988
 收藏 7
分类专栏： opensips 文章标签： mysql opensips
版权

华为云开发者联盟
该内容已被华为云开发者联盟社区收录，社区免费抽大奖🎉，赢华为平板、Switch等好礼！
加入社区

opensips
专栏收录该内容
1 篇文章0 订阅
订阅专栏
注意注意：opensips的组件安装，默认是root用户，如果是非root用户，中间会产生很多权限问题，我这里用的是非root用户，会将其中出现的问题展示出来。root用户按照以下步骤安装会更加简单。
下载资源文件都放在 /usr/src/目录下，我安装的是2.4.3版本，安装前执行：
sudo chmod 777 -R /usr/src/

一、mysql安装
opensips添加鉴权用户需使用mysql存储，当然也可使用redis存储。

1、安装
这里安装的是5.6版本
（1）下载安装包
sudo wget http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm

这时会有如下错误（没有就忽略）：
wget: unable to resolve host address ‘dev.mysql.com’
无法解析主机地址。这就能看出是DNS解析的问题。
在这里插入图片描述

解决方案：
进入/etc/resolv.conf。
修改内容为下
nameserver 8.8.8.8 #google域名服务器
nameserver 8.8.4.4 #google域名服务器
如果没有vim命令：
安装：yum -y install vim*
（2）安装
sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm
sudo yum install mysql-community-server

2、查看是否安装成功
rpm -qa|grep mysql，安装完成如下：
在这里插入图片描述

3、安装后启动
sudo service mysqld restart

4、登陆mysql
mysql -u root

5、修改密码
set password for ‘root’@‘localhost’ =password(‘123456’);

6、设置客户端连接
这一步是为了更加方便的操作数据库，或者更加清晰的看到数据库信息。我用的客户端是navicat。
直接连接，会有如下异常：
Host ‘XXX’ is not allowed to connect to this MySQL server
解决方案：
use mysql;
CREATE USER ‘root’@’ %’ IDENTIFIED BY ‘123456’;
flush privileges;

二、opensips安装
Opensips需要很多依赖包，我们先安装一部分，然后在安装过程中需要什么我们就安装什么。

1、安装依赖包
sudo yum install mysql mysql-server mysql-libs mysql-devel
sudo yum install gcc make
sudo yum install flex bison ncurses libncurses-dev ncurses-devel

2、下载并解压opensips的源码
在usr/src目录下：
sudo wget http://opensips.org/pub/opensips/latest/opensips-2.4.3.tar.gz
如果下载不了，可去官网下载。
解压：tar zxvf opensips-2.4.3.tar.gz
进入：cd opensips-2.4.3/

3、编译
如果希望使用默认编译选项编译，直接执行
Make all
如果希望修改编译参数，执行
make menuconfig
我们在这里执行sudo make menuconfig，一定要sudo
此时会进入这样一个页面：
在这里插入图片描述

进入“Configure Compile Options”：
在这里插入图片描述

再进入 “Configure Excluded Modules”
在这里插入图片描述

空格键选择“db_mysql”
左键返回上一层，“Save Changes”，回车执行
在这里插入图片描述

最后，再返回上一层，选择“Compile And Install OpenSIPS”，回车执行，等待安装完成。
在这里插入图片描述

4、配置文件目录
在usr/src目录下安装opensips，其安装文件分布如下：
/usr/src //opensips安装路径
/usr/local/ //安装文件根目录
├── etc//配置目录
│ └── opensips
│ ├── opensips.cfg //主要配置脚本文件
│ ├── opensipsctlrc
│ ├── osipsconsolerc
├── lib64
│ └── opensips
│ ├── modules //包含的模块动态库的目录
│ │ ├── acc.so
│ │ ├── alias_db.so
…
│ │ └── usrloc.so
│ └── opensipsctl //命令行MI操作用到的文件
│ ├── dbtextdb
│ │ └── dbtextdb.py
│ ├── opensipsctl.base
│ ├── opensipsctl.ctlbase
│ ├── opensipsctl.dbtext
│ ├── opensipsctl.fifo
│ ├── opensipsctl.mysql
│ ├── opensipsctl.sqlbase
│ ├── opensipsctl.unixsock
│ ├── opensipsdbctl.base
│ ├── opensipsdbctl.dbtext
│ └── opensipsdbctl.mysql
├── sbin
│ ├── opensips //opensips程序可执行文件（启动opensips）
│ ├── opensipsctl //用于opensips命令行MI操作的脚本
│ ├── opensipsdbctl //opensips数据库操作脚本
│ ├── opensipsunix
│ ├── osipsconfig
│ └── osipsconsole
以上目录的权限均需修改：
sudo chmod 777 -R /usr/local/
注意：这里需要给以上目录添加sudo权限，编辑/etc/sudoers文件，更改secure_path配置如下：
在这里插入图片描述
这里是为sudo命令定义PATH环境变量。保存即生效。

5、配置数据库信息
cd /usr/local/etc/opensips/
sudo vim opensipsctlrc
配置如下：
在这里插入图片描述

6、配置opensips
cd /usr/local/sbin/
sudo osipsconfig
如下图所示：
依次选择–> Generate OpenSIPS Script –> Residential Script–> Configure Residential Script
在这里插入图片描述

空格选中以上四项。然后左键返回，选中“Generate Residential Script”，回车，会生成新的cfg文件：
在这里插入图片描述

进入cd /usr/local/etc/opensips/
如图所示：
在这里插入图片描述
更改文件权限：
sudo chmod 777 -R opensips_residential_2022-2-11_14:55:21.cfg
拷贝和替换原有配置文件：
mv opensips.cfg opensips.cfg.old
mv opensips_residential_2022-2-11_14:55:21.cfg opensips.cfg
修改opensips.cfg：
sudo vim opensips.cfg
如图所示修改：
在这里插入图片描述
修改完数据库配置后使用opensipsdbctl新建数据库：
cd /usr/local/sbin/
sudo opensipsdbctl create
这时候会有如下异常：
Access denied for user ‘root’@‘localhost.localdomain’ (using password: YES)
在这里插入图片描述
可以看出是数据库不支持localhost.localdomain形式去连接，那好办，新增就行了，如下：
use mysql;
CREATE USER ‘root’@‘localhost.localdomain’ IDENTIFIED BY ‘123456’;
flush privileges;
再继续执行sudo opensipsdbctl create，执行成功。这个时候，opensips数据库和用户创建成功：
在这里插入图片描述

三、启动与停止
1、前台运行
如果需要让opensips在前台运行，便于调试和查看日志，可以在opensips.cfg配置文件中设置：
debug_mode = yes
该选项默认为no。然后在安装根目录下直接执行sbin/opensips文件运行opensips/

2、后台运行
将debug_mode配置项设置为no，或屏蔽掉该配置项，然后适用脚本进行启动和停止
启动：opensipsctl start
重启：opensipsctl restart
停止：opensipsctl stop

3、启动失败
先进行下一步日志配置，如果启动失败，可以看到日志。
我这边启动失败，报错为：
在这里插入图片描述

解决方案：
mysql -u root
grant all privileges on opensips.* to opensips@localhost identified by ‘opensipsrw’;
flush privileges;
重启成功。

四、日志配置
OpenSIPS使用syslog服务写日志，所以缺省情况下日志会写入/var/log/message这个系统日志文件中。
更改步骤：
1、opensips.cfg配置debug_mode=no及log_stderror=no时日志才会写文件。
2、在sudo vim /etc/rsyslog.conf中，增加一行：
local0.* /data/opensips/logs/opensips.log
3、重启rsyslog服务：sudo systemctl restart rsyslog.service
注意：我这边测试的日志写入比较慢。目前还没有解决办法。
debug_mode=yes 是开启调试模式，前台运行，详细见上文。

参考：https://www.jianshu.com/p/4f17429cfdcd
https://mp.weixin.qq.com/s?__biz=MzI1NjY1ODQ0OQ==&mid=2247483672&idx=1&sn=4ba52c38910711d2d01597b23946f118&scene=19#wechat_redirect

文章知识点与官方知识档案匹配，可进一步学习相关知识
MySQL入门技能树安装和登录安装34312 人正在系统学习中

李王家的翠花
关注

3


7
打赏

0

专栏目录
opensips-2.3.3手册中文版
05-25
opensips2.3.3 中文参考手册，基于官方文档的翻译版本
关于opensips用户认证配置文件 opensips.cfg 使用介绍
01-10
opensips用户认证配置文件-opensips.cfg opensips.cfg配置文件，红色标记的为添加修改的部分，亲自测试！ ## $Id: opensips.cfg 9742 2013-02-05 10:24:48Z vladut-paiu $## OpenSIPS residential configuration script#     by OpenSIPS Solutions ## This script was generated via “make menuconfig”, from#   the “Residen
opensips超全部署部署教程及必要配置详解_果冻小玩纸的博客_o...
1-29
cd /usr/local/lib64/opensips/opensipsctl #因为下边执行的时候要用到./mysql相对录径所以执行前要先到这个目录来 /usr/local/sbin/opensipsdbctl create #创建数据库和表 5.检查配置是否有报错 /usr/local/sbin/opensipsctl -c...
opensips实战教程(三):路由脚本介绍与实战_I_O_fly的博客
1-19
如果你想在路由脚本中调用自己编写的函数(如上面例子中的cache_raw_query函数),或者添加自定义的脚本全局变量(如上面例子中的$au变量)都是不难实现的,这需要编写拓展模块和修改OpenSIPS的源码,而这又是一大块内容了。后续章节将会讲到Op...
centos7 yum安装opensips-3-2 opensips-cli
weixin_46382137的博客
 379
通过yum 方式安装opensips opensips-cli
opensips服务器(sip服务器)端搭建、安装过程，什么是Xshell，Xshell下载
最新发布
m0_51292856的博客
 57
opensips服务器搭建的前提环境: Ubuntu虚拟机、xshell命令客户端，并且成功连接网络。 1. xshell xshell是一个安全终端模拟软件，该软件可在Windows界面下远端访问不同系统下的服务器，比如服务器被放在远端机房，那就可以在我们的电脑上通过xshell软件进行远程控制，并且支持VB、JS、Python 等脚本语言，支持SSH(Secure Shell)安全外壳协议，是用于安全远程登录和其他安全网络服务的协议。xshell通过使用SSH把所有传输的数据进行加密，这样能够防止D
Opensips学习教程(五)-负载均衡配置与应用_峰桦追梦的博客_s...
1-31
OpenSIPS负载均衡由load_balancer模块实现,配置是在load_balancer表中配置的,如下图load_balancer表字段: 各个设置项的意义: id:该行负载配置的唯一id,当使用MI命令将某个处于enable=no(不可用)状态的负载服务器置为可用时,会用到这个...
Opensips 3.3.1安装配置_opensips安装_Amazing_7的博客
1-30
根据个人需要可以选择使用make menuconfig菜单选择配置,也可以使用make all 编译 OpenSIPS 核心及其所有配置的模块 make menuconfig make all make install 注:也可通过设置apt下载源,进行apt安装。进入opensips官网->Downloads->2. packages...
opensips安装教程
似曾相识燕归来的博客
 6993
1.前言 系统为centos 安装的opensips版本为opensips-2.2.2 2.安装mysql已经安装mysql的可跳过这一步 在root身份下执行如下命令：wget http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm rpm -ivh mysql-community-relea
CentOS7环境下搭建opensips服务器
qq_38229263的博客
 700
OpenSIPS 是用于语音、视频、IM、在线状态和任何其他SIP扩展的开源 SIP 代理服务器。
安装配置opensips过程记录_CHCH998的博客
1-25
原文地址为:安装配置opensips过程记录 本文操作系统为CentOS,所用Opensips版本为1.8.2。 Update2013/6/27: 版本1.9.1也已验证通过,下载地址为http://opensips.org/pub/opensips/latest/src/opensips-1.9.1_src.tar.gz ...
opensips实战教程(四): 使用自己的账号系统鉴权_I_O_fly的博客
1-27
1、OpenSIPS对请求进行鉴权 1.1 SIP鉴权请求过程 2、鉴权模块配置 3、REGISTER注册请求鉴权 4、Proxy代理请求鉴权 前言 注册鉴权和代理鉴权鉴权是RFC3261中规定的,但这不是强制要求的,事实上在实践中很多时候是不用鉴权的,一是鉴权需要...
opensips源代码安装与配置的技巧方法
09-15
本篇文章小编为大家介绍，opensips源代码安装与配置的技巧方法。需要的朋友参考下
UBUNTU上安装OPENSIPS
柳鲲鹏
 682
　　这个链接够详细，吾就不重复了。 　　其中有一个笔误，大家注意一下就是了。   　　特别是其中提到： 注意：在Ubuntu12.04中的源如下，但是这个源在14.04中并不能使用：  deb http://ag-projects.com/ubuntu precise main           deb-src http://ag-projects.com/ubuntu precise...
OpenSIPS 3.1 开发手册(一)--事件架构、内存管理、SIP消息解析
1-30
这份教程标的是OpenSIPS 3.1 LTS版本。 2. 整体架构 TBD \\ 3. 内存管理 OpenSIPS 有自己的内存分配器。相比系统内存分配器,它具有以下几点重要的优势: 硬限制OpenSIPS使用内存的能力 比系统内存分配器更具性能优势 ...
opensip安装部署教程视频终端可注册
06-07
opensips最新版本注册，宝利通终端可注册，用于视频会议硬件终端注册学习
docker-opensips:适用于OpenSIPS的Docker映像存储库
05-28
OpenSIPS Docker映像 用于构建和启动OpenSIPS映像的Docker配方 建立形象 您可以通过运行以下命令构建docker映像： make build 此命令将使用git存储库中的OpenSIPS主版本构建docker映像。 要构建不同的git版本，可以运行： OPENSIPS_VERSION=2.2 make build 要使用MySQL支持进行构建： OPENSIPS_EXTRA_MODULES=opensips-mysql-module make build 要开始图像，只需运行： make start 变数 您可以设置不同的变量来调整您的部署： OPENSIPS_VERSION设置opensips版本（默认值： 3.1 ） OPENSIPS_BUILD指定要使用的releases （ nightly或releases releases ）（默认
OpenSIPS实战（一）：OpenSIPS使用简介
 5054
OpenSIPS实战（一）：OpenSIPS使用简介 1、OpenSIPS是什么 OpenSIPS（Open SIP Server）是一个成熟的开源SIP服务器实现,可以作为SIP代理/路由器。 但OpenSIPS不仅仅是一个SIP代理/路由器，因为它包含了应用程序级别的功能。 OpenSIPS作为SIP服务器，可以作为任何基于SIP的VoIP解决方案的核心组件。 凭借非常灵活和可定制的路由引擎（路由脚本），和提供可扩展（模块化)设计，以高效的方式统一了语音，视频，IM和状态服务。OpenSIPS的可靠性和
opensips1.5.1带源码_附linux环境安装方法
07-22
opensips是一个功能不错的开源sip server，这里以ubuntu为例，说明一下在linux环境的安装。 1.下载opensips并解压缩。 2.打开Makefile，修改exclude_modules参数，将要用到的模块从exclude列表中去除。 3.make all. 这步会遇到不少找不到包的情况。如：按我需求修改后的Makefile，用到xml开发包和mysql开发包的支持。所以要安装libxml，libmysql-dev，libexpat-dev。这步会跟据用到的功能不同，需要按装的包也不同。 4.make install安装 5.修改/user/local/etc/opensips/opensipsctlrc关于DB的配置，创建DB（命令如下）。期间要改变mysql的root账号的远程登录权限 >>cd /usr/local/sbin/ >>opensipsdbctl create 6.修改opensips.cfg配置，再启动opensip。主要是要设置对数据库IP, server IP，*.so的path，其它配不对启动时会有提示。注意不同版本设置略有不同，因为支持的script有点不同。启动的命令如下： >>cd /usr/local/sbin >>./opensips
【opensips（一）】ubuntu16.04安装opensips
qq_36069590的博客
 1380
因为之前接触过kamailio，毕竟和opensips是同源的，很多使用方法、模块都相似，安装过程感到很熟悉，另外opensips有一个图形控制界面menuconfig，能够很方便的进行安装、脚本生成及配置。 一、下载源码 我下载的是当前稳定版本2.4.5：http://download.opensips.org/ 解压缩放进了目录/usr/local/src/中。 二、安装依赖...
opensips2.4.2服务器
09-01
安装部署详解https://blog.csdn.net/hua588hb/article/details/82287279
Centos 下安装opensips详细流程
gjy_it的博客
 2054
1.mysql安装（因opensips添加鉴权用户需使用mysql存储） &lt;下载资源文件都放在 /usr/src/为例&gt; 命令： wget http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm rpm -ivh mysql-community-release-el7-5.noarch.rpm yum in...
在CentOS8上部署Opensip SIP服务器
一个孤独的Coder...在需求中成长，在压力中勇进；不怕夜深人静的夜晚，不怕空无一人的街道...
 1199
yum install openssl-devel https://www.cnblogs.com/setout/p/11249507.html https://blog.csdn.net/love_xunmeng/article/details/44672129 [root@localhost /]# yum install mysql [root@localhost /]# yum install mysql-server [root@localhost /]# yum install mysql-de
opensips 安装 rtpproxy 教程
似曾相识燕归来的博客
 5874
opensips 安装 rtpproxy 教程1.前言版本信息：opensips-2.2.22.安装rtpproxygit clone -b master https://github.com/sippy/rtpproxy.git cd rtpproxy git -C rtpproxy submodule update --init --recursive ./configure make可能会出现的问题 cc1
centos下安装opensips
极乐净土
 7314
转载自：http://blog.csdn.net/haolipengzhanshen/article/details/44672005 一 准备工作  yum install gcc make  yum install flex bison ncurses libncurses-dev ncurses-devel 安装Mysql数据库  yum install mys
opensips安装
神在细节之中
 7370
转载自 ：http://www.cnblogs.com/bjzhanghao/archive/2013/02/13/2910903.html   文操作系统为CentOS，所用Opensips版本为1.8.2。 Update2013/6/27: 版本1.9.1也已验证通过，下载地址为http://opensips.org/pub/opensips/latest/src/opensips-1.
“相关推荐”对你有帮助么？

非常没帮助

没帮助

一般

有帮助

非常有帮助
©️2022 CSDN 皮肤主题：大白 设计师：CSDN官方博客 沉浸阅读: CSDN浏览器助手 返回首页
关于我们
招贤纳士
商务合作
寻求报道

400-660-0108

kefu@csdn.net

在线客服
工作时间 8:30-22:00
公安备案号11010502030143
京ICP备19004658号
京网文〔2020〕1039-165号
经营性网站备案信息
北京互联网违法和不良信息举报中心
家长监护
网络110报警服务
中国互联网举报中心
Chrome商店下载
账号管理规范
版权与免责声明
版权申诉
出版物许可证
营业执照
©1999-2023北京创新乐知网络技术有限公司
目录
一、mysql安装
1、安装
2、查看是否安装成功
3、安装后启动
4、登陆mysql
5、修改密码
6、设置客户端连接
二、opensips安装
1、安装依赖包
2、下载并解压opensips的源码
3、编译
4、配置文件目录
5、配置数据库信息
6、配置opensips
三、启动与停止
1、前台运行
2、后台运行
3、启动失败
四、日志配置





×
拖拽到此处
图片将完成下载

评论

笔记
